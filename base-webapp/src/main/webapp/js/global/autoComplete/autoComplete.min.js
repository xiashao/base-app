(function(a){a.fn.extend({gAuto:function(i){var c=a.extend(true,{},a.fn.gAuto.defaults,i);var k=0;var w=0;var t;var m=true;var q;var r;var j=f();var n;var u;var l=a("#autoTipImg");a(this).off(".autoComplete").on("keydown.autoComplete keyup.autoComplete blur.autoComplete",function(A){t=a(this);if(t.attr("readonly")){return}o();var z=A.which;var y=A.type;if(y=="keydown"&&j[0].style.display!="none"){s(z,A)}if(y=="keyup"){if(A.ctrlKey||A.shiftKey||z==a.gAuto.keyCode.SHIFT){return}e(z)}if(y=="blur"&&m){t.val()==""&&d("");j.hide()}});if(c.staticWithScroll){var x=a(document).scrollTop();a(window).scroll(function(){var z=a(document).scrollTop();var y=z-x;if(y>0){j.css("top",u+y)}else{j.css("top",u-y);x=z}})}function p(B){var y=t.attr("reqUrl");var A=t.val().trim();var z=t.data("gautoflag");a.ajax({type:"POST",url:y==undefined?c.url:y,dataType:"json",data:{keyword:A,flag:z,isShowAll:B},error:function(){l.html("<i class='fa fa-exclamation-triangle'></i><span> "+a.gAuto.i18n.dataReturnError+"</span>")},success:function(C){if(C!=""){w=C.length;if(w>10){j.css({height:j.height(),overflowY:"scroll"})}l[0].innerHTML=h(C,A,B);n=j.find("div.item-div");j.show();t.focus();g();k=0;q=n.eq(0);v(undefined,q)}else{l.html("<i class='fa fa-exclamation-triangle'></i><span> "+a.gAuto.i18n.dataNotFound+"</span>");w=0}}})}function o(){j.removeClass().addClass("div-auto").css({left:t.offset().left,top:t.offset().top+t.outerHeight(),height:"240px",overflowY:"auto",paddingLeft:0});var y=t.data("gClass");if(y){j.addClass(y)}var z="0";var A="0";if(t.css("paddingLeft")!=undefined){z=t.css("paddingLeft").replace("px","")}if(t.css("paddingRight")!=undefined){A=t.css("paddingRight").replace("px","")}var B=parseFloat(t.width())+parseFloat(z)+parseFloat(A);j.width()<B&&j.width(B);u=t.offset().top+t.outerHeight()}function e(y){if(t.val()!=""){if(y!=a.gAuto.keyCode.RIGHT&&y!=a.gAuto.keyCode.DOWN&&y!=a.gAuto.keyCode.LEFT&&y!=a.gAuto.keyCode.UP&&y!=a.gAuto.keyCode.ENTER&&y!=a.gAuto.keyCode.CONTROL&&y!=a.gAuto.keyCode.TAB){d("");j[0].style.display=="none"&&j.show();l.html("<span class='auo-text-loading'>"+a.gAuto.i18n.loading+"…</span>");p(false)}}else{j.hide();d("")}}function s(y,z){if(y==a.gAuto.keyCode.RIGHT||y==a.gAuto.keyCode.DOWN){k=k+1>=w?0:k+1;r=n.eq(k);v(q,r);j.scrollTop((k-11)*20)}if(y==a.gAuto.keyCode.LEFT||y==a.gAuto.keyCode.UP){k=k<1?w-1:k-1;r=n.eq(k);v(q,r);j.scrollTop((k-11)*20)}if(y==a.gAuto.keyCode.ENTER||y==a.gAuto.keyCode.TAB){z.preventDefault();r=q;w!=0&&v(undefined,q,true);j.hide()}q=r}function g(){a("#isShowAll").off(".autoComplete").on("mousedown.autoComplete",function(){l.html("<span class='auo-text-loading'>"+a.gAuto.i18n.loading+"…</span>");var y=t.attr("reqUrl");p(true)});n.hover(function(){q=a(this);v(n.eq(k),q);k=n.index(this)},function(){v(a(this))}).off(".autoComplete").on("mousedown.autoComplete",function(){v(undefined,a(this),true);j.hide()})}function h(C,z,D){var B="";for(var A=0;A<C.length;A++){var y=C[A].name.replace(new RegExp(z,"i"),"<b><span style='color:red'>$&</span></b>");B=B+"<div class='item-div' strId='"+C[A].id+"'>"+y+"</div>"}if(!D){B=B+"<div class='show-all-div'><a id='isShowAll' class='auto-text-btn'>"+a.gAuto.i18n.showAll+"</a></div>"}return B}function v(z,A,y){z&&z.css({"background":"#FFFFFF"});if(A!==undefined){A.css({background:"#FBEC88"});if(y){t.val(A.text());d(A.attr("strId"));if(c.selectedCallback){c.selectedCallback(t)}}}}function d(y){t.setGAutoHiddenValue(y)}function f(){if(a("#autoTipDiv").size()==0){a("body").append("<div id='autoTipDiv' class='auto-tip-div'>"+"<iframe style='position:absolute; z-index:-1;width:110px;' frameborder='0' src='about:blank'></iframe>"+"<div id='autoTipImg'></div></div>")}return a("#autoTipDiv").hover(function(){m=false},function(){m=true}).off(".autoComplete").on("scroll.autoComplete",function(){t&&t.focus()})}return this},getGAutoHiddenValue:function(){return this.data("hiddenValue")},setGAutoHiddenValue:function(c){return this.data("hiddenValue",c)}});var b=(function(){var d=window.location+"";var e=d.split("//");var c=e[1].split("/");return e[0]+"//"+window.location.host+"/"+c[1]+"/"})();a.fn.gAuto.defaults={staticWithScroll:false,selectedCallback:null,url:b+"autoComplete"};a.gAuto=function(){a("input[data-gautoflag]").gAuto()};a.gAuto.i18n={loading:"加载中",showAll:"显示全部",dataReturnError:"The returned data is error!",dataNotFound:"无可用数据!"};a.gAuto.keyCode={ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,F7:118,F12:123,S:83,WINDOWS:91}})(jQuery);